!function(a){a.widget("dui.timefield",{version:"1.0.1",widgetName:"timefield",widgetEventPrefix:"timefield",options:{timeZone:"24",disableH:!1,disableM:!1,disableS:!1,showS:!0,supportShow24:!1,beginTime:"",endTime:"",change:a.noop},_create:function(){var b=this,c=b.options;b.element.addClass("u-input-group").empty(),a('<input type="text" class="u-input" maxlength="2"/>').prop("disabled",c.disableH).appendTo(b.element),a("<span>:</span>").appendTo(b.element),a('<input type="text" class="u-input" maxlength="2"/>').prop("disabled",c.disableM).appendTo(b.element),a("<span>:</span>").appendTo(b.element);var d=a('<input type="text" class="u-input" maxlength="2"/>').prop("disabled",c.disableS).appendTo(b.element);d.toggle(c.showS).prev("span").toggle(c.showS),this.$noonLabel=a('<label type="text" class="u_timefield_label">AM</label>').appendTo(b.element),this.$noonLabel.toggle(12==c.timeZone),b.inputs=b.element.find("input").each(function(d,e){var f=0,g=59;d||(f="24"===c.timeZone?0:1,g="24"===c.timeZone?c.supportShow24?24:23:12),a(e).numberfield({allowDecimal:!1,allowNegative:!1,max:g,min:f,pad:2,error:function(a,b){"range"===b.type&&1===b.ui.options.min&&12===b.ui.options.max&&b.ui.value(12)}}).blur(function(){var d="1970/1/1 ",e=null,f=null,g=null;this.value=a.pad(this.value,2),e=new Date(d+b.value()),""!=b.options.endTime&&(f=new Date(d+b.options.endTime),e>f&&b.value(b.options.endTime)),""!=b.options.beginTime&&(g=new Date(d+b.options.beginTime),g>e&&b.value(b.options.beginTime)),c.supportShow24&&b.inputs.eq(0).val()-0==24&&(b.inputs.eq(1).val("00"),b.inputs.eq(2).val("00")),b._trigger("change",null,{ui:b,value:b.value()})}).data("index",d)}),b._on(b._handleEvents),b.disableList=["disableH","disableM","disableS"]},run:function(){var b=this,c=new Date;clearInterval(this.interval),b.interval=setInterval(function(){var d=b.value(),e=d.split(":");c.setHours(e[0],e[1],e[2]),"23"===e[0]&&"59"===e[1]&&"59"===e[2]?b._trigger("onAddDay"):"59"===e[1]&&"59"===e[2]?b._trigger("onAddHour"):"59"===e[2]&&b._trigger("onAddMinute"),c.addSeconds(1),b.value(c.getHours()+":"+c.getMinutes()+":"+c.getSeconds()),b.inputs.each(function(b,c){c===document.activeElement&&a(c).select()})},1e3)},isRun:function(){return!!this.interval},stop:function(){clearInterval(this.interval),this.interval=null},value:function(b){if(0===arguments.length){var c=[];return this.inputs.each(function(){c.push(a.pad(this.value,2))}),12==this.options.timeZone&&("PM"==this.$noonLabel.text()?12!=c[0]&&(c[0]=c[0]-0+12):"AM"==this.$noonLabel.text()&&12==c[0]&&(c[0]=a.pad(0,2))),c.join(":")}this._changeFormat(b)},_changeFormat:function(b){var c=b.split(":");12==this.options.timeZone?(this.$noonLabel.text(c[0]-0>=12?"PM":"AM"),0==c[0]?c[0]=12:c[0]-0>12&&(c[0]=c[0]-12),this.$noonLabel.show()):this.$noonLabel.hide(),this.inputs.each(function(b,d){a(d).numberfield("value",a.pad(c[b],2))})},beginTime:function(a){this.options.beginTime=a},endTime:function(a){this.options.endTime=a},format:function(a){var b=this.value();this.options.timeZone="12"===a?"12":"24";var c="24"===this.options.timeZone?0:1,d="24"===this.options.timeZone?this.options.supportShow24?24:23:12;this.inputs.eq(0).numberfield("min",c).numberfield("max",d),this._changeFormat(b)},disabled:function(b){var c=this;a.each(b,function(a,b){var d=c.disableList.indexOf(a);d>-1&&(c.inputs.eq(d).prop("disabled",b),c.options[a]=b)})},_handleEvents:{"keyup input":function(b){var c=a(b.target),d=c.data("index");if(this.stop(),!(9===b.which||c.val().length<2))if(2!==d){var e=this.inputs.eq(d+1);e.prop("disabled")?c.blur():e.select()}else c.blur()},"click label":function(b){this.stop();var c=a(b.target);c.text("AM"==c.text()?"PM":"AM")}}})}(jQuery);