!function(a){a.widget("dui.numberfield",a.dui.textfield,{version:"1.0.1",widgetName:"numberfield",widgetEventPrefix:"numberfield",options:{max:!1,min:!1,value:0,allowDecimal:!0,decimalPrecision:!1,allowNegative:!0,preventValue:[],errorHandle:"prevent",error:a.noop,success:a.noop},_create:function(){var a=this.options;if(a.max===!1){var b=this.element.attr("max");b=parseFloat(b),isNaN(b)||(a.max=b)}if(a.min===!1){var c=this.element.attr("min");c=parseFloat(c),isNaN(c)||(a.min=c)}var d=this.element.val();""===d&&this.element.val(this.options.value),this._blurHandleVal(!0),this._super()},_init:function(a){this._setOption(a),this._blurHandleVal(!0)},_setupEvents:function(){var b=a.ui.ie&&a.browser.version<=8?"keyup":"input",c={blur:this._blurHandleVal,paste:this._inputHandleVal};c[b]=this._inputHandleVal,this._on(c)},_getRegStr:function(b){var c=this.options,d="^";if(c.allowNegative&&(d+="-?"),d+="("+(c.pad?"":"[1-9]")+"(\\d*)|[0])",b||(d+="*"),c.allowDecimal)if(d+=b===!1?"\\.?[\\d]":"(\\.[\\d]",c.decimalPrecision){d+="{"+(b===!1?0:1)+","+c.decimalPrecision+"}"+(b===!1?"":")*");var e=new RegExp(d,"g"),f=this.value();e.test(f)&&"number"===a.type(f)&&(this.oldValue=f.toString().match(e))}else d+=b===!1?"*":"+)*";return d+="$"},_inputHandleVal:function(a){if(!a||"propertychange"!==a.type||"value"===a.originalEvent.propertyName){var b=this.options,c=this._getRegStr(!1);b.validReg=new RegExp(c),a&&this._handValue(a)}},_blurHandleVal:function(b){var c=this.options,d=this._getRegStr(!0);if(c.validReg=new RegExp(d),b){this._handValue(b);var c=this.options,e=this.element.val();e=parseFloat(e),isNaN(e)?(e=c.min||0,this.element.val(e)):"prevent"==c.errorHandle&&this.prevent()?this._trigger("error",b,{ui:this,type:"prevent"}):(c.max!==!1&&e>c.max&&(e=c.max,this._setValue(e,!1),this._trigger("error",b,{ui:this,type:"range"})),c.min!==!1&&e<c.min&&(e=c.min,this._setValue(e,!1),this._trigger("error",b,{ui:this,type:"range"})));var f=this.options.pad;f&&this._setValue(a.pad(this.value(),f),!1)}},_handValue:function(){this._super();this.oldValue=parseFloat(this.oldValue),isNaN(this.oldValue)||this.oldValue<this.options.min?this.oldValue=this.options.min||0:this.oldValue>this.options.max&&(this.oldValue=this.options.max||0,this.options.max&&this.value(this.oldValue))},_setOption:function(a,b){this._super(a,b),"value"===a&&this.element.val(b),this._blurHandleVal(!0)},max:function(a){this._setOption("max",a)},min:function(a){this._setOption("min",a)},prevent:function(){return-1!==a.inArray(this.element.val()-0,this.options.preventValue)},value:function(a){return 0===arguments.length?this.element.val()-0:(this.element.val(a),void this._blurHandleVal(!0))}})}(jQuery);