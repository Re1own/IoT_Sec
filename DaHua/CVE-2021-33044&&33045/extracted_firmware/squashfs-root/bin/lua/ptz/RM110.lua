-- 这是大华协议，已经调好，不用更改
local Protocol = {};

-- 表示数值可以用16或10进制(最小值，最大值)
Protocol.Attr = 
{
	-- 协议的显示名称,不能超过16字符，目前暂不支持中文
	Name = "RM110A",	
		
	-- 指明是云台协议还是矩阵协议，使用"PTZ", "MATRIX"表示
	Type = "PTZ",
	
	-- 以ms为单位
	Internal = 200,
				
	-- 没有对应的地址范围，请都设成0xff
	-- 云台地址范围
	CamAddrRange 		= {0x01, 0xFF}, 
	-- 监视地址范围
	MonAddrRange		= {0x01, 0xff},	
	-- 预置点范围
	PresetRange 		= {0x00, 0x40},
	-- 自动巡航线路范围
	TourRange		= {0x01, 0x01},
	-- 轨迹线路范围
	PatternRange		= {0x01, 0x05},
	-- 垂直速度范围
	TileSpeedRange 		= {0x01, 0xFF},
	-- 水平速度范围
	PanSpeedRange 		= {0x01, 0xFF},
	-- 自动扫描范围
	ScanRange 			= {0x01, 0x05},
	
	-- 辅助范围
	AuxRange 		= {0x00, 0x0f},
}

Protocol.CommandAttr =
{
	-- 协议中需要更改的位置，用LUA下标表示，即下标从１开始,用10进制表示
	AddrPos 		  = 4, 
	PresetPos 		= 5, 
	TileSpeedPos 	= 5,
	PanSpeedPos 	= 5,
	AuxPos 			  = 5,
}

Protocol.Command = 
{
	-- 写具体协议时只能用16进制或字符表示,没有的话就注释掉
	Start= 
	{
		--写上下左右, 左上，左下，右上，右下
		TileUp 		= "0xf6, 0x47, 0x00, 0x00, 0x09, 0x01, 0x00,",
		TileDown 	= "0xf6, 0x48, 0x00, 0x00, 0x09, 0x01, 0x00,",
		PanLeft 	= "0xf6, 0x45, 0x00, 0x00, 0x09, 0x01, 0x00,", 
		PanRight 	= "0xf6, 0x46, 0x00, 0x00, 0x09, 0x01, 0x00,",

		ZoomWide 	= "0xf6, 0x4b, 0x00, 0x00, 0x09, 0x01, 0x00",
		ZoomTele 	= "0xf6, 0x4c, 0x00, 0x00, 0x09, 0x01, 0x00",
		FocusNear	= "0xf6, 0x4e, 0x00, 0x00, 0x09, 0x01, 0x00",
		FocusFar 	= "0xf6, 0x4d, 0x00, 0x80, 0x09, 0x01, 0x00",
		IrisSmall       = "0xf6, 0x49, 0x00, 0x00, 0x09, 0x01, 0x00",
		IrisLarge       = "0xf6, 0x4a, 0x00, 0x00, 0x09, 0x01, 0x00",
			

			
		-- 预置点操作（设置，清除，转置)
		SetPreset 	= "0xf6, 0x52, 0x00, 0x00, 0x00, 0x0f, 0x00",
		ClearPreset	= "0xf6, 0x01, 0x00, 0x05, 0x00, 0x0f, 0x00",
		GoToPreset 	= "0xf6, 0x54, 0x00, 0x00, 0x00, 0x0f, 0x00",			
		
		SetLeftLimit 	= "0xf6, 0x5c, 0x00, 0x00, 0x01, 0x0f, 0x00",
		SetRightLimit	= "0xf6, 0x5c, 0x00, 0x00, 0x00, 0x0f, 0x00", 
		AutoScanOn 	= "0xf6, 0x5d, 0x00, 0x00, 0x01, 0x0f, 0x00,",
		AutoScanOff	= "0xf6, 0x5d, 0x00, 0x00, 0x00, 0x0f, 0x00,",	
			
		-- 自动巡航，一般指在预置点之间巡航

		AddTour 	= "0xf6, 0x55, 0x00, 0x00, 0x00, 0x0f, 0x00",
		DeleteTour 	= "0xf6, 0x56, 0x00, 0x00, 0x00, 0x0f, 0x00",
		StartTour 	= "0xf6, 0x59, 0x00, 0x00, 0x01, 0x0f, 0x00",
		StopTour 	= "0xf6, 0x59, 0x00, 0x00, 0x00, 0x0f, 0x00",
		
		--辅助功能
		AuxOn  = "0xf6, 0x5e, 0x00, 0x00, 0x00, 0x01, 0x00",
		AuxOff = "0xf6, 0x5e, 0x00, 0x00, 0x00, 0x00, 0x00",

	},
	Stop = 
	{
		TileUp 		= "0xf6, 0x48, 0x00, 0x00, 0x00, 0x01, 0x00,",
		TileDown 	= "0xf6, 0x48, 0x00, 0x00, 0x00, 0x01, 0x00,",
		PanLeft 	= "0xf6, 0x48, 0x00, 0x00, 0x00, 0x01, 0x00,", 
		PanRight 	= "0xf6, 0x48, 0x00, 0x00, 0x00, 0x01, 0x00,",

		ZoomWide 	= "0xf6, 0x4a, 0x00, 0x00, 0xff, 0x01, 0x00",
		ZoomTele 	= "0xf6, 0x4a, 0x00, 0x00, 0xff, 0x01, 0x00",
		FocusNear	= "0xf6, 0x4a, 0x00, 0x00, 0xff, 0x01, 0x00",
		FocusFar 	= "0xf6, 0x4a, 0x00, 0x00, 0xff, 0x01, 0x00",
		IrisSmall       = "0xf6, 0x4a, 0x00, 0x00, 0xff, 0x01, 0x00",
		IrisLarge       = "0xf6, 0x4a, 0x00, 0x00, 0xff, 0x01, 0x00",
	},
}

Protocol.Checksum = function (s)
         local sum = math.mod((s[2] + s[3] + s[4] + s[5] + s[6]), 256);
         s[7] = math.mod(sum,128);
	 return s;
end;


Protocol.CamAddrProcess = function(s, addr)
       s[4] = math.mod(addr,128);
       s[3] = math.floor(addr/128) * 128;
       return s ;
end;

Protocol.SpeedProcess = function(s, arg1, arg2)    
      return s;
end;

Protocol.MultipleProcess = function(s,arg1)
      if s[5] == 0xff then
         s[5] = 0x00;
         return s;
      end;
      return s;
end;

Protocol.SetTourProcess = function(s, tour, preset)
        s[5] = preset;
	return s;
end;

Protocol.TourProcess = function(s, tour)
	return s;	
end;



--[[
下面的函数是可选的，除非有特殊处理过程才打开，没有的话，千万不要打开，否则会造成解析出错
Protocol.MonAddrProcess = function(s, addr)
	return s;
end;

Protocol.SpeedProcess = function(s, arg1, arg2)
	return s;
end;

Protocol.PresetProcess = function(s, arg)
	return s;
end;
--]]


return Protocol;